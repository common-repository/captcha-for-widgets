(function(e){function n(t,n,r){var i="captcha_validation_error_"+n;t.append(e("<div />").attr("id","captcha_holder_"+n));e("#captcha_holder_"+n).realperson({length:r.cfw_options.realperson_length,regenerate:r.cfw_options.realperson_regenerate,includeNumbers:r.cfw_options.realperson_numbers!=null&&r.cfw_options.realperson_numbers==1,hashName:"defaultReal"+n+"Hash"});e("#captcha_holder_"+n).append(e("<input />").attr("type","text").attr("id","defaultReal"+n).attr("name","defaultReal"+n).addClass("hasRealPerson").css("border","1px solid #bebebe"));t.prepend(e("<div />").attr("id",i).css("padding","5px").css("color","red").hide());t.find('input[type="submit"]').click(function(){var s=e("#defaultReal"+n).val();var o=e('input[name="defaultReal'+n+'Hash"]').val();if(s==="")e("#"+i).html("Please fill in the captch field.").show();else{e("#"+i).html("").hide();e.ajax({url:r.admin_ajax_url,data:{action:"cfw_validate_realperson",response:s,challenge:o},dataType:"HTML",type:"POST",asynch:false,success:function(n){if(n=="OK"){e("#"+i).html("").hide();t.submit()}else{e("#"+i).html(n).show();return false}}})}return false})}function r(t,n,r){var i="captcha_validation_error_"+n;t.append(e("<div />").attr("id","captcha_holder_"+n));if(typeof Recaptcha!=="undefined"){Recaptcha.create(r.cfw_options.captcha_public_key,"captcha_holder_"+n,{theme:r.cfw_options.captcha_theme,callback:Recaptcha.focus_response_field});t.prepend(e("<div />").attr("id",i).css("padding","5px").css("color","red").hide());t.find('input[type="submit"], a[id*="submit"]').click(function(){var n=e("#recaptcha_response_field").val();var s=e("#recaptcha_challenge_field").val();if(n==="")e("#"+i).html("Please fill in the captch field.").show();else{e("#"+i).html("").hide();e.ajax({url:r.admin_ajax_url,data:{action:"cfw_validate_captcha",response:n,challenge:s},dataType:"HTML",type:"POST",asynch:false,success:function(n){if(n=="OK"){e("#"+i).html("").hide();t.submit()}else{e("#"+i).html(n).show();Recaptcha.reload();return false}}})}return false})}}var t={cfw_options:{},captcha_api:"",admin_ajax_url:""};e.fn.mycaptcha=function(i){var s=e.extend({},t,i);var o=0;return this.each(function(){var t=e(this);if(!t.attr("id")||t.attr("id")!="searchform"&&t.attr("id")!="adminbarsearch"){if(s.cfw_options){submitCleaner();if(s.cfw_options.from==="tab_recaptcha"){r(t,o,s);o++}else if(s.cfw_options.from==="tab_realperson"){n(t,o,s);o++}}}})};showRecaptcha=function(t,n){var r="<noscript>"+'<iframe src="http://www.google.com/recaptcha/api/noscript?k='+t.cfw_options.captcha_public_key+'"'+'height="300" width="500" frameborder="0"></iframe><br>'+'<textarea name="recaptcha_challenge_field" rows="3" cols="40">'+"</textarea>"+'<input type="hidden" name="recaptcha_response_field"'+'value="manual_challenge">'+"</noscript>";e("#captcha_holder_"+n).append(r)};submitCleaner=function(){if(e('input[name="submit"]').length>0){var t=0;e('input[name="submit"]').each(function(){e(this).attr("name","submit_"+t);t++})}if(e("input#submit").length>0){var t=0;e("input#submit").each(function(){e(this).attr("id","submit_"+t);t++})}}})(jQuery)